language: cpp
matrix:
  include:
  - compiler: gcc
before_install:
- sudo add-apt-repository --yes ppa:ubuntu-sdk-team/ppa
- sudo apt-get update -qq
- sudo apt-get install -qq qt5-qmake qtbase5-dev qtdeclarative5-dev libqt5webkit5-dev
  libsqlite3-dev
- sudo apt-get install -qq libqt4-dev libqt4-opengl-dev zlib1g-dev cppcheck
- qmake -qt=qt4 -v
- qmake -qt=qt5 -v
script:
- QMAKE_OPTS="-qt=qt4" make deb
- make clean
- QMAKE_OPTS="-qt=qt5" make deb
after_script:
- pushd src
- cppcheck --enable=all -q `git ls-files *.cpp *.c`
- pushd openspin/repo
- cppcheck --enable=all -q `git ls-files *.cpp`
deploy:
  provider: releases
  api_key:
    secure: Aqc568913TUntnDfhy16yL5kqOgw5aMppFlO6C3hsDaZIFFpV9A8azQo9853uavCuGWXgIG4kt4qZcGl6aTWiDbVFI0MoOdXkNERhuWSaAPwWXZ2xz+vhl9SXW9jL5zj2ERTMsIC9AvhUuqMIWgkluq51MzTQnXxS9C6ph+5Jo4=
  file_glob: true
  file: staging/propelleride-*.deb
  skip_cleanup: true
  on:
    repo: parallaxinc/PropellerIDE
    tags: true
    all_branches: true
